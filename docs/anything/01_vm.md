# What to install on a fresh VM?

When you get a new VM, there are some settings you should do before using it. In this section, Iâ€™ve listed the useful commands and setups I usually run the first time I use a VM.

## Check network configurations

```bash
ip addr show          # Show all network interfaces and IP addresses
ip route show         # Show current routing table (gateway, etc.)
cat /etc/resolv.conf  # Show current DNS settings
hostname -I           # Show assigned IP(s)
```

## SSH settings

Install (if not already):

```bash
sudo apt update && sudo apt install openssh-server
```

Check status:

```bash
sudo systemctl status ssh
```

Change SSH config:

```bash
sudo nano /etc/ssh/sshd_config
```

Reload SSH after changes:

```bash
sudo systemctl restart ssh
```

### Copy SSH Key

Copy your default keys at `~/.ssh/id_rsa` and `~/.ssh/id_rsa.pub`.

```bash
ssh-copy-id -p 130 user@VM_IP
```

It will ask for your password one last time, then add the key to:

```bash
~/.ssh/authorized_keys
```

Make sure the SSH server allows key auth in /etc/ssh/sshd_config:

```bash
PubkeyAuthentication yes
AuthorizedKeysFile .ssh/authorized_keys
```

Then restart SSH:

```bash
sudo systemctl restart ssh
```

## Checking Firewall

See status:

```bash
sudo ufw status verbose
```

Allow SSH:

```bash
sudo ufw allow ssh
```

Enable firewall:

```bash
sudo ufw enable
```

Allow a specific port (example: HTTP):

```bash
sudo ufw allow 80/tcp
```

Remove the rule:

```bash
sudo ufw delete allow 80/tcp
```

## Configure Gateway & DNS

Check current:

```bash
ip route | grep default
```

Set a new one:

```bash
sudo ip route replace default via 192.168.1.1
```

> Permanent: set it in Netplan or /etc/network/interfaces (older systems).

```
iface eth0 inet static
    address 192.168.1.50
    netmask 255.255.255.0
    gateway 192.168.1.1
    dns-nameservers 8.8.8.8 1.1.1.1
```

Restart networking:

```bash
sudo systemctl restart networking
```

> Check the `/etc/resolv.conf` if not using Netplan.

## Disk Info

Show disk usage:

```bash
df -h
```

Show detailed disk and partition info:

```bash
lsblk
```

## RAM Info

Show total and used memory:

```bash
free -h
```

Detailed memory info:

```bash
cat /proc/meminfo
```

## CPU Info

Summary:

```bash
lscpu
```

Detailed CPU info:

```bash
cat /proc/cpuinfo
```

## Sys Info

Show system info:

```bash
hostnamectl
```

Show overall hardware info:

```bash
lshw -short
```

Show kernel version:

```bash
uname -r
```

Show OS version:

```bash
cat /etc/os-release
```
